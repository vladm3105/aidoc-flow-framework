# =============================================================================
# ðŸ“‹ Document Authority: This is the PRIMARY STANDARD for CTR YAML structure.
# All other documents (Schema, Creation Rules, Validation Rules) DERIVE from this template.
# - In case of conflict, this template is the single source of truth
# - Schema: CTR_SCHEMA.yaml - Machine-readable validation (derivative)
# - Creation Rules: CTR_CREATION_RULES.md - AI guidance for document creation (derivative)
# - Validation Rules: CTR_VALIDATION_RULES.md - AI checklist after document creation (derivative)
#   NOTE: VALIDATION_RULES includes all CREATION_RULES and may be extended for validation
# =============================================================================
#
# SCHEMA_REFERENCE: CTR_SCHEMA.yaml
# SCHEMA_VERSION: 1.0

# Reference Template â€” For learning and small contracts only. Real CTRs should follow '../DOCUMENT_SPLITTING_RULES.md' and 'CTR/CTR_SPLITTING_RULES.md'. Split into paired sections when needed: 'CTR-{NN}.{S}_{slug}.md' + 'CTR-{NN}.{S}_{slug}.yaml'.

# Contract ID: Must match filename (CTR-XXX_name)
contract_id: template_contract
contract_version: "1.0.0"
service_type: [agent|mcp|infra|shared]

# Traceability
upstream_requirements:
  - REQ-NN
upstream_adrs:
  - ADR-NN

# Interface Definitions
endpoints:
  - name: function_name
    description: "What this endpoint does"
    synchronous: true  # true for sync, false for async

    request_schema:
      type: object
      required: [field1, field2]
      properties:
        field1:
          type: string
          description: "Purpose of field1"
          example: "sample_value"
        field2:
          type: integer
          minimum: 0
          description: "Purpose of field2"
          example: 42

    response_schema:
      type: object
      required: [status, result]
      properties:
        status:
          type: string
          enum: [success, error]
          description: "Operation outcome"
        result:
          type: object
          description: "Response payload when status=success"
        error_code:
          type: string
          description: "Error identifier when status=error"
        error_message:
          type: string
          description: "Human-readable error description when status=error"

    error_codes:
      - code: INVALID_INPUT
        http_status: 400
        description: "Invalid request parameters"
        retry_safe: false
      - code: RESOURCE_NOT_FOUND
        http_status: 404
        description: "Requested resource does not exist"
        retry_safe: false
      - code: RATE_LIMITED
        http_status: 429
        description: "Too many requests"
        retry_safe: true
      - code: INTERNAL_ERROR
        http_status: 500
        description: "Internal processing error"
        retry_safe: true

# Quality Attributes
quality_attributes:
  max_latency_ms: 100
  min_throughput_rps: 1000
  idempotent: true
  retry_strategy: exponential_backoff
  max_retries: 3
  timeout_ms: 5000
  circuit_breaker:
    failure_threshold: 5
    timeout_seconds: 60
    half_open_max_calls: 3

# Versioning
versioning:
  breaking_changes: false
  backward_compatible: true
  deprecation_date: null
  migration_guide_url: null

# security
security:
  authentication_required: true
  authentication_method: [api_key|oauth|mtls]
  authorization_required: true
  rate_limiting:
    requests_per_second: 100
    burst_size: 150
  encryption:
    in_transit: tls_1_3
    at_rest: false
